<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>The Modern Web Is A Quagmire, So I Embraced NoScript | Jay Little</title>
<meta name="keywords" content="">
<meta name="description" content="If you are a regular visitor, you know that I normally I update my site with new content on a monthly basis. However the events of the last 24 hours have compelled me to break with tradition and reach out to the wider world as soon as possible.
I already hear you asking, &ldquo;What happened Jay?&rdquo; Well the modern web happened, that&rsquo;s what. Since I&rsquo;m a web developer you are probably operating under the assumption that I&rsquo;m acquainted with the modern web and it&rsquo;s basic rules more-so than most.">
<meta name="author" content="Jay Little">
<link rel="canonical" href="https://jaylittle.com/post/view/2019/8/the-modern-web-is-a-quagmire-so-i-embraced-noscript/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css" integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://jaylittle.com/favicon.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://jaylittle.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://jaylittle.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://jaylittle.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://jaylittle.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://jaylittle.com/post/view/2019/8/the-modern-web-is-a-quagmire-so-i-embraced-noscript/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
  

<meta property="og:title" content="The Modern Web Is A Quagmire, So I Embraced NoScript" />
<meta property="og:description" content="If you are a regular visitor, you know that I normally I update my site with new content on a monthly basis. However the events of the last 24 hours have compelled me to break with tradition and reach out to the wider world as soon as possible.
I already hear you asking, &ldquo;What happened Jay?&rdquo; Well the modern web happened, that&rsquo;s what. Since I&rsquo;m a web developer you are probably operating under the assumption that I&rsquo;m acquainted with the modern web and it&rsquo;s basic rules more-so than most." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jaylittle.com/post/view/2019/8/the-modern-web-is-a-quagmire-so-i-embraced-noscript/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2019-08-21T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-08-21T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="The Modern Web Is A Quagmire, So I Embraced NoScript"/>
<meta name="twitter:description" content="If you are a regular visitor, you know that I normally I update my site with new content on a monthly basis. However the events of the last 24 hours have compelled me to break with tradition and reach out to the wider world as soon as possible.
I already hear you asking, &ldquo;What happened Jay?&rdquo; Well the modern web happened, that&rsquo;s what. Since I&rsquo;m a web developer you are probably operating under the assumption that I&rsquo;m acquainted with the modern web and it&rsquo;s basic rules more-so than most."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://jaylittle.com/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "The Modern Web Is A Quagmire, So I Embraced NoScript",
      "item": "https://jaylittle.com/post/view/2019/8/the-modern-web-is-a-quagmire-so-i-embraced-noscript/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "The Modern Web Is A Quagmire, So I Embraced NoScript",
  "name": "The Modern Web Is A Quagmire, So I Embraced NoScript",
  "description": "If you are a regular visitor, you know that I normally I update my site with new content on a monthly basis. However the events of the last 24 hours have compelled me to break with tradition and reach out to the wider world as soon as possible.\nI already hear you asking, \u0026ldquo;What happened Jay?\u0026rdquo; Well the modern web happened, that\u0026rsquo;s what. Since I\u0026rsquo;m a web developer you are probably operating under the assumption that I\u0026rsquo;m acquainted with the modern web and it\u0026rsquo;s basic rules more-so than most.",
  "keywords": [
    
  ],
  "articleBody": "If you are a regular visitor, you know that I normally I update my site with new content on a monthly basis. However the events of the last 24 hours have compelled me to break with tradition and reach out to the wider world as soon as possible.\nI already hear you asking, “What happened Jay?” Well the modern web happened, that’s what. Since I’m a web developer you are probably operating under the assumption that I’m acquainted with the modern web and it’s basic rules more-so than most. You aren’t wrong. However I am not infallible. That having been said, the events of the last 24 hours have forced me to take a long hard stare at one of my blind spots, produce a full accounting of the horrors that were subsequently revealed to me and react accordingly.\nSo how did my world get upended? Well it started with this Reddit thread in which the subject of discussion is a video Linus Tech Tips made about browsing the web anonymously. Please note: I am not endorsing this video. It contains so much inaccuracy and bad advice that it should probably be pulled from their channel. Now while I was reading through the thread and enjoying reading rants about the inaccuracies in the video, it occurred to me that I haven’t spent much time considering my browsers fingerprint.\nFor those not in the know, fingerprinting refers generically to any technique in tech that can be used to identify a specific device and/or user. This makes browser fingerprinting insanely important because it means that unless you make an effort to make your fingerprint less specific and less unique, you can still be tracked regardless of whether or not you block ads, trackers and use a VPN to browse the web.\nKeep in mind that at this point, I was still feeling damn good. But at some point somebody posted a link to the EFFs fingerprint testing utility in the thread and I clicked on through thinking that the results would only serve to further reinforce how great I was doing with privacy. I couldn’t have been more wrong. The schadenfreude I was experiencing suddenly became the sinking feeling in the pit of my stomach as I realized that I was completely and utterly full of shit.\nBut wait, what the hell happened? I use Linux. I use Firefox. I do all kinds of things that make my life harder but also theoretically increase my level of relative privacy in a variety of circumstances. Turns out that a lot of these choices were actually serving to make my browser fingerprint more unique. After all how many people are in the habit of browsing the web from a Linux laptop? How many people actually use Firefox as their primary browser? Hint: the combination of those two factors alone makes me much easier to identify. Throw in a few odd font choices and the fact that my odd screen resolution combined with my specific UI config in Firefox creates a situation where not only was I easy to identify, but my signature was actually unique:\nThis was not an easy revelation for me to bear. Everything I was doing was thrown into flux. I immediately began trying to find another more secure browser that wouldn’t allow people to do this to me. After about an hour of madly bouncing around the web like a chicken with my head cut off (and likely being tracked quite competently the entire time, hopefully the irony won’t be lost on our tech overlords) it suddenly hit me like a bag of bricks:\nWithout JavaScript, most of this shit is not possible.\nWhile I could have just disabled JavaScript for every single website in my browser, as a web developer I knew that this approach was doomed to end poorly. Too many sites and apps that I actually trust and use on a daily basis actually require JavaScript in order to work at all. In addition, browser fingerprinting actually makes sense when paired with multi-factor authentication (MFA) methods as it allows me to validate my device once and not bother with doing so until something important changes. Hell I would even argue that a more unique fingerprint actually enhances my security in that particular scenario. For more information on both the upsides and downsides of unique browser fingerprints as well as other possible mitigations that I don’t cover here, feel free to read this wonderful Pixel Privacy article on the subject.\nSo now I needed a way to globally disable JavaScript by default but be able to turn it back on for specific domains that I am willing to trust. Well that road leads to one place and it is a place that I have resisted going for a long time. What is this place called? NoScript. Just to provide the proper context here, I once hated the idea of NoScript so much that I went out of my way to mock users who had it enabled that came to this website. Lets take a gander at some of the source code for version 4.x of the Presentation Engine:\nNow in case you aren’t picking up on the full joke there, markup between the noscript tags in HTML will only render for users that have JavaScript disabled. In addition that content was encased in blink tags which though deprecated in every web browser worth talking about, I had added JavaScript code to re-enable. The joke of course was that since you were using NoScript I couldn’t even competently annoy you.\nHowever by the time I started writing version 5.x (the version you are using now), I was feeling a bit more sympathy for NoScript users and made an extra special effort to make Presentation Engine support NoScript users who choose to consume content. The admin tools still very much require JavaScript but as a consumer, no JavaScript is required at this point. At the time my purpose wasn’t to support NoScripters as much as it was to build the fastest website imaginable.\nTo summarize I installed NoScript into Firefox and set it up appropriately. Here are the results of the EFF test afterwards:\nMuch much better, right? And since I’m able to conditionally re-enable JavaScript for sites and apps that I trust, I can still benefit from my unique fingerprint in situations where it makes sense for me to have that. The bottom line here is that I strongly encourage every single one of my readers to install and configure NoScript in their browser as soon as possible.\nBeyond installing NoScript, the real goal of this post is to get people to ask the question: How did we get to this place? Who is writing all of this nefarious code that is tracking all of us? Who is designing all of these apps which exploit our addictive tendencies in order to keep our eyeballs glued to them?\nThe answer is simple: Web Developers. I am a Web Developer and I have refused and will continue to refuse to do these kinds of things. I used to work with a client that wanted me to maintain their corporate website and help them create more ways to track their users activity. I refused and eventually dumped the client while citing those kinds of requests as one of my primary reasons.\nAs a web professional, I am disheartened by the reality that we aren’t doing any better than this. As a tech professional, I am disgusted at the growing collection of evidence which indicates that not only are we stunningly amoral but that we are apparently okay with exploiting the trust of our users in an effort to turn them into mindless click bots who might be more willing to buy shit they don’t need.\nWe can do better and we should do better. I can only hope that fellow professionals who stumble on this post will take my words into consideration and at least consider changing their ways by not only adopting consistent and ethical standards but by holding themselves accountable to them. Because at the end of the day, the JavaScript itself isn’t the problem as it is only a tool which does what it is told.\n2020-02-03 Update: I have since switched from NoScript to uMatrix. It provides a much better end user experience and the default settings (which allow resources loaded from first party domains) allow a lot of sites to at least somewhat work without tweaking the rules.\n",
  "wordCount" : "1421",
  "inLanguage": "en",
  "datePublished": "2019-08-21T00:00:00Z",
  "dateModified": "2019-08-21T00:00:00Z",
  "author":[{
    "@type": "Person",
    "name": "Jay Little"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://jaylittle.com/post/view/2019/8/the-modern-web-is-a-quagmire-so-i-embraced-noscript/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Jay Little",
    "logo": {
      "@type": "ImageObject",
      "url": "https://jaylittle.com/favicon.png"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://jaylittle.com/" accesskey="h" title="Jay Little (Alt + H)">Jay Little</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://jaylittle.com/article/view/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://jaylittle.com/post/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://jaylittle.com/resume/" title="Resume">
                    <span>Resume</span>
                </a>
            </li>
            <li>
                <a href="https://jaylittle.com/article/view/jay-and-annette-wedding-2004/" title="Family">
                    <span>Family</span>
                </a>
            </li>
            <li>
                <a href="https://jaylittle.com/article/view/recipes/" title="Recipes">
                    <span>Recipes</span>
                </a>
            </li>
            <li>
                <a href="https://jaylittle.com/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://jaylittle.com/">Home</a>&nbsp;»&nbsp;<a href="https://jaylittle.com/post/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      The Modern Web Is A Quagmire, So I Embraced NoScript
    </h1>
    <div class="post-meta"><span title='2019-08-21 00:00:00 +0000 UTC'>August 21, 2019</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;Jay Little

</div>
  </header> 
  <div class="post-content"><p>If you are a regular visitor, you know that I normally I update my site with new content on a monthly basis.  However the events of the last 24 hours have compelled me to break with tradition and reach out to the wider world as soon as possible.</p>
<p>I already hear you asking, &ldquo;What happened Jay?&rdquo;  Well the modern web happened, that&rsquo;s what.  Since I&rsquo;m a web developer you are probably operating under the assumption that I&rsquo;m acquainted with the modern web and it&rsquo;s basic rules more-so than most.  You aren&rsquo;t wrong.  However I am not infallible.  That having been said, the events of the last 24 hours have forced me to take a long hard stare at one of my blind spots, produce a full accounting of the horrors that were subsequently revealed to me and react accordingly.</p>
<p>So how did my world get upended?  Well it started with <a href="https://www.reddit.com/r/privacy/comments/ct5by5/linus_tech_tips_newest_video_has_a_lot_of_bad/">this Reddit</a> thread in which the subject of discussion is a video Linus Tech Tips made about browsing the web anonymously.  Please note: I am not endorsing this video.  It contains so much inaccuracy and bad advice that it should probably be pulled from their channel.  Now while I was reading through the thread and enjoying reading rants about the inaccuracies in the video, it occurred to me that I haven&rsquo;t spent much time considering my browsers fingerprint.</p>
<p>For those not in the know, fingerprinting refers generically to any technique in tech that can be used to identify a specific device and/or user.  This makes browser fingerprinting insanely important because it means that unless you make an effort to make your fingerprint less specific and less unique, you can still be tracked regardless of whether or not you block ads, trackers and use a VPN to browse the web.</p>
<p>Keep in mind that at this point, I was still feeling damn good.  But at some point somebody posted a link to the <a href="https://panopticlick.eff.org/">EFFs fingerprint testing utility</a> in the thread and I clicked on through thinking that the results would only serve to further reinforce how great I was doing with privacy.  I couldn&rsquo;t have been more wrong.  The schadenfreude I was experiencing suddenly became the sinking feeling in the pit of my stomach as I realized that I was completely and utterly full of shit.</p>
<p>But wait, what the hell happened?  I use Linux.  I use Firefox.  I do all kinds of things that make my life harder but also theoretically increase my level of relative privacy in a variety of circumstances.  Turns out that a lot of these choices were actually serving to make my browser fingerprint more unique.  After all how many people are in the habit of browsing the web from a Linux laptop?  How many people actually use Firefox as their primary browser?  Hint: the combination of those two factors alone makes me much easier to identify.  Throw in a few odd font choices and the fact that my odd screen resolution combined with my specific UI config in Firefox creates a situation where not only was I easy to identify, but my signature was actually unique:</p>
<figure class="align-center ">
    <img loading="lazy" src="/images/NoScriptBefore.png#center"
         alt="Results Before Installing NoScript"/> 
</figure>

<p>This was not an easy revelation for me to bear.  Everything I was doing was thrown into flux.  I immediately began trying to find another more secure browser that wouldn&rsquo;t allow people to do this to me.  After about an hour of madly bouncing around the web like a chicken with my head cut off (and likely being tracked quite competently the entire time, hopefully the irony won&rsquo;t be lost on our tech overlords) it suddenly hit me like a bag of bricks:</p>
<p><strong>Without JavaScript, most of this shit is not possible.</strong></p>
<p>While I could have just disabled JavaScript for every single website in my browser, as a web developer I knew that this approach was doomed to end poorly.  Too many sites and apps that I actually trust and use on a daily basis actually require JavaScript in order to work at all.  In addition, browser fingerprinting actually makes sense when paired with multi-factor authentication (MFA) methods as it allows me to validate my device once and not bother with doing so until something important changes.  Hell I would even argue that a more unique fingerprint actually enhances my security in that particular scenario.  For more information on both the upsides and downsides of unique browser fingerprints as well as other possible mitigations that I don&rsquo;t cover here, feel free to read this wonderful <a href="https://pixelprivacy.com/resources/browser-fingerprinting/">Pixel Privacy article</a> on the subject.</p>
<p>So now I needed a way to globally disable JavaScript by default but be able to turn it back on for specific domains that I am willing to trust.  Well that road leads to one place and it is a place that I have resisted going for a long time.  What is this place called?  <a href="https://noscript.net/">NoScript</a>.  Just to provide the proper context here, I once hated the idea of NoScript so much that I went out of my way to mock users who had it enabled that came to this website.  Lets take a gander at some of the source code for version 4.x of the Presentation Engine:</p>
<figure class="align-center ">
    <img loading="lazy" src="/images/NoScriptTaunt.png#center"
         alt="Old Source Level Taunt For No-Scripters"/> 
</figure>

<p>Now in case you aren&rsquo;t picking up on the full joke there, markup between the noscript tags in HTML will only render for users that have JavaScript disabled.  In addition that content was encased in blink tags which though deprecated in every web browser worth talking about, I had added JavaScript code to re-enable.  The joke of course was that since you were using NoScript I couldn&rsquo;t even competently annoy you.</p>
<p>However by the time I started writing version 5.x (the version you are using now), I was feeling a bit more sympathy for NoScript users and made an extra special effort to make Presentation Engine support NoScript users who choose to consume content.  The admin tools still very much require JavaScript but as a consumer, no JavaScript is required at this point.  At the time my purpose wasn&rsquo;t to support NoScripters as much as it was to build the fastest website imaginable.</p>
<p>To summarize I installed NoScript into Firefox and set it up appropriately.  Here are the results of the EFF test afterwards:</p>
<figure class="align-center ">
    <img loading="lazy" src="/images/NoScriptAfter.png#center"
         alt="Results After Installing NoScript"/> 
</figure>

<p>Much much better, right?  And since I&rsquo;m able to conditionally re-enable JavaScript for sites and apps that I trust, I can still benefit from my unique fingerprint in situations where it makes sense for me to have that.  The bottom line here is that I strongly encourage every single one of my readers to install and configure NoScript in their browser as soon as possible.</p>
<p>Beyond installing NoScript, the real goal of this post is to get people to ask the question: How did we get to this place?  Who is writing all of this nefarious code that is tracking all of us?  Who is designing all of these apps which exploit our addictive tendencies in order to keep our eyeballs glued to them?</p>
<p>The answer is simple:  Web Developers.  I am a Web Developer and I have refused and will continue to refuse to do these kinds of things.  I used to work with a client that wanted me to maintain their corporate website and help them create more ways to track their users activity.  I refused and eventually dumped the client while citing those kinds of requests as one of my primary reasons.</p>
<p>As a web professional, I am disheartened by the reality that we aren&rsquo;t doing any better than this.  As a tech professional, I am disgusted at the growing collection of evidence which indicates that not only are we stunningly amoral but that we are apparently okay with exploiting the trust of our users in an effort to turn them into mindless click bots who might be more willing to buy shit they don&rsquo;t need.</p>
<p>We can do better and we should do better.  I can only hope that fellow professionals who stumble on this post will take my words into consideration and at least consider changing their ways by not only adopting consistent and ethical standards but by holding themselves accountable to them.  Because at the end of the day, the JavaScript itself isn&rsquo;t the problem as it is only a tool which does what it is told.</p>
<p><strong>2020-02-03 Update</strong>: I have since switched from NoScript to <a href="https://github.com/gorhill/uMatrix">uMatrix</a>.  It provides a much better end user experience and the default settings (which allow resources loaded from first party domains) allow a lot of sites to at least somewhat work without tweaking the rules.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="https://jaylittle.com/">Jay Little</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
